<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play customgame</title>
    <link rel="icon" type="image/x-icon" href="../Assets/favicon-32x32.png">
    <link href="./styles.css" rel="stylesheet">
</head>
<body>
    <p>runs at 30fps!<br>running proper collision code since 28 February 2024</p>
    <button onclick="start()">Start</button>
    <nav id="snakenav">
    <canvas id="canvas" width="1000" height="600"></canvas>
        <a href="../index.html" alt="Home">
            <img src="../Assets/ClubLogo.png" id="homepage">
        </a>
        <a href="./main.html" alt="Calculator">
            <img src="../Assets/calculator.jpg" id="calculatorpage">
        </a>
    </nav>
</body>
</html>
<script>
    c = document.getElementById('canvas');
    ctx = c.getContext('2d');

    var canvasWidth = c.width;
    var canvasHeight = c.height;
    
    var colliders = [];
    var antiColliders = [];
    var roomNumber = 0;

    createBox(30,30,60,60,0);
    createAntiBox(30,30,60,60,0);
    
    var movement;
    var drawing;

    var col = {
        xmax: canvasWidth - 50,
        xmin: 10,
        ymax: canvasHeight - 50,
        ymin: 10,
        
    };

    function start() {
        movement = setInterval(playerMovement,1);
        drawing = setInterval(draw,50);
    }
    
    var player = {
        x: 10,
        y: 10,
        px: 0,
        py: 0,
        w: 40,
        h: 40,
        speed: 40,
    };

    function playerMovement() {
        document.onkeydown = function(e) {
            player.px = player.x;
            player.py = player.y;
            switch(e.keyCode) {
                case 37: 
                    player.x -= player.speed;
                    break; 
                case 38: 
                    player.y -= player.speed;
                    break; 
                case 39: 
                    player.x += player.speed;
                    break; 
                case 40: 
                    player.y += player.speed;
                    break;
                default:
                    break;
            }
        };
        if(player.x < col.xmin || player.x > col.xmax || player.y < col.ymin || player.y > col.ymax) {
            player.x = player.px;
            player.y = player.py;
        }

        for(var i = 0; i<colliders.length; i+=5) {
            if(player.x>=colliders[i] && player.x<colliders[i]+colliders[i+2] && player.y>=colliders[i+1] && player.y<colliders[i+1]+colliders[i+3] && colliders[i+4] == roomNumber) {
                if(player.x>=antiColliders[i] && player.x<antiColliders[i]+antiColliders[i+2] && player.y>=antiColliders[i+1] && player.y<antiColliders[i+1]+antiColliders[i+3] && antiColliders[i+4] == roomNumber) {
                    
                } else {
                    player.x = player.px;
                    player.y = player.py;
                }
            }
        }
    }
    
    function draw() {
        ctx.clearRect(0,0,canvasWidth,canvasHeight);

        ctx.fillStyle = "white";
        for(var i = 0; i<colliders.length; i+=5) {
            if(colliders[i+4] == roomNumber) {
                ctx.fillRect(colliders[i],colliders[i+1],colliders[i+2],colliders[i+3]);
            }
        }

        ctx.fillStyle = "black";
        
        for(var i = 0; i<antiColliders.length; i+=5) {
            if(antiColliders[i+4] == roomNumber) {
                ctx.fillRect(antiColliders[i],antiColliders[i+1],antiColliders[i+2],antiColliders[i+3]);
            }
        }

        ctx.fillStyle = "red"
        ctx.fillRect(player.x,player.y,player.w,player.h);
    }

    function createBox(x,y,w,h,rm) {
        while( (x - 10) % player.w != 0 ) {
            x++;
        }

       while( (y - 10) % player.h != 0 ) {
            y++;
        }
        
        while(w % player.w != 0) {
            w++;
        }

        while(h % player.h != 0) {
            h++;
        }
        
        colliders.push(x);
        colliders.push(y);
        colliders.push(w);
        colliders.push(h);
        colliders.push(rm);
    }

    function createAntiBox(x,y,w,h,rm) {
        while( (x - 10) % player.w != 0 ) {
            x++;
        }

       while( (y - 10) % player.h != 0 ) {
            y++;
        }
        
        while(w % player.w != 0) {
            w++;
        }

        while(h % player.h != 0) {
            h++;
        }

        antiColliders.push(x);
        antiColliders.push(y);
        antiColliders.push(w);
        antiColliders.push(h);
        antiColliders.push(rm);
    }

    function createDialogueBox(x,y,w,h,rm) {
        while( (x - 10) % 20 != 0 ) {
            x++;
        }

       while( (y - 10) % 20 != 0 ) {
            y++;
        }
        
        while(w % 20 != 0) {
            w++;
        }

        while(h % 20 != 0) {
            h++;
        }

        antiColliders.push(x);
        antiColliders.push(y);
        antiColliders.push(w);
        antiColliders.push(h);
        antiColliders.push(rm);
    }
</script>
